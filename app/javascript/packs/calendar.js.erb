import $ from 'jquery';
import 'fullcalendar';

$(document).on('ready turbolinks:load', function()
{
    //AJAX Event call
    var events
    $.ajax({
        type: "get",
        url: "/events",
        dataType: "json",
        success: function(data)
        {
            //FullCalendar
            events = data
            $('#calendar').fullCalendar({
                events: events,
                editable: true,
                eventDrop: function( event, delta, revertFunc, jsEvent, ui, view ) {
                    $.ajax({
                        type: "patch",
                        url: "/events/" + event.id,
                        dataType: "json",
                        data: {event: {start: event.start.format()}, authenticity_token: "<%= form_authenticity_token %>"}
                    })
                },
                themeSystem: 'bootstrap4',
                header: 
                {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay,listMonth'
                },
                weekNumbers: true,
                navLinks: true,
                eventLimit: true
            })
        }
    });
})